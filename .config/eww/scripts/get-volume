#!/bin/bash
vol=$(wpctl get-volume @DEFAULT_AUDIO_SINK@ 2>/dev/null | awk '{print int($2 * 100)}')
muted=$(wpctl get-volume @DEFAULT_AUDIO_SINK@ 2>/dev/null | grep -q MUTED && echo true || echo false)

if [[ "$muted" == "true" ]]; then
    icon="󰝟"
elif ((vol > 66)); then
    icon="󰕾"
elif ((vol > 33)); then
    icon="󰖀"
else
    icon="󰕿"
fi

echo "{\"percent\":$vol,\"muted\":$muted,\"text\":\"$icon $vol%\"}"
